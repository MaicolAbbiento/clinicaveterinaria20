
@{
    ViewBag.Title = "SearchByMNumber";
}

<div>
    @Html.ActionLink("ᐊ", "Home", null, new { @class = "btn btn-light btn-lg m-4 rounded-pill border-0" })
</div>

<h2>Ricerca per microchip</h2>

<div class="d-flex flex-column justify-content-around align-items-center flex-grow-1 mx-4">
    <label for="nmicrochipInput">Inserire numero di microchip:</label>
    <input id="nmicrochipInput" class="form-control w-100 rounded-pill p-2" type="text" />
    <button id="bottone" class="btn btn-light rounded-pill border-0 w-25 fw-semibold p-2">Cerca</button>
    <div id="risultati" style="display:none;">
        <div class="card" style="width: 18rem;">
            <img class="card-img-top" src="" alt="Immagine">
            <div class="card-body">
                <h5 class="card-title"></h5>
                <p class="card-text"></p>
            </div>
        </div>
    </div>

    <div id="errore" style="display:none;">Nessun animale trovato con il numero di microchip inserito.</div>
</div>





@section scripts{
    <script>
        $(document).ready(function() {
            $("#bottone").click(function () {
                let numero = $("#nmicrochipInput").val()
                $("#errore").hide()
                $("#risultati").hide()
                $.ajax({
                    type: "POST",
                    url: "SearchByMNumber",
                    data: { nmicrochip: numero },
                    success: function (data) {

                        $("#risultati").show()
                        $(".card-img-top").attr("src", `/Content/img/uploads/${data.foto}`)
                        $(".card-title").html(data.nome)
                        $(".card-text").html(`${data.tipo} di colore ${data.coloreMantello}`)
                    },
                    error: function(){
                        $("#errore").show()
                    }
                    
                })
            })
        })
    </script>
    }